clear all; close all; clc;
the =0; the_dot = 0; psi = 0;psi_dot = 0; phi = 0; phi_dot= 0;
  %% declare the parameter
  %%% ?i?m c?n tuy?n tính % diem can tuyen tinh the = 0; the_dot = 0; psi = 0;psi_dot = 0; phi = 0; phi_dot= 0;
g =9.81; % gravity acceleration
m =0.03; % wheel weight
R =0.04; % Wheel radius
M =0.6;  % body weight
W =0.14; % Body width
D =0.04; % Body depth
H =0.144;% Body Height
L =0.144/2;% distance
J_psi  = M*L^2/3; % Body inertia moment
Jw = m*R^2/2;  %Wheel inertia moment
J_phi = M*(W^2+D^2)/12; % Body yaw inertia moment
Jm = 0.00001; % Dc motor inertia moment
g =9.81; % gravity acceleration
m =0.03; % wheel weight
R =0.04; % Wheel radius
M =0.6;  % body weight
W =0.14; % Body width
D =0.04; % Body depth
H =0.144;% Body Height
L =0.144/2;% distance
J_psi  = M*L^2/3; % Body inertia moment
Jw = m*R^2/2;  %Wheel inertia moment
J_phi = M*(W^2+D^2)/12; % Body yaw inertia moment
Jm = 0.00001; % Dc motor inertia moment
Rm = 6.69; % Dc motor resitance
Kb = 0.468; % DC motor EMF
Kt = 0.317; % DC motor torque const
n =1 ; %gear ratio
fm = 0.0022; % friction cof between body and DC motor.
fw = 0; % friction cof between wheel and floor

n =1 ; %gear ratio
anp = n*Kt/Rm;
bet = n*Kt*Kb/Rm +fm;
vl = 0; vr = 0;
% fm = 0.0022; % friction cof between body and DC motor.
% fw = 0; % friction cof between wheel and floor
 AA1 = ...
[ 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0, 0,                                                                                                                                                                                                                                                                                                  0;
  0,          (2*bet*(2*Jm*n^2 - L*M*R*cos(psi)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) - ((2*bet + 2*fw)*(M*L^2 + 2*Jm*n^2 + J_psi))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)),  ((2*Jm*n^2 - L*M*R*cos(psi))*(L*M*g*cos(psi) + L^2*M*phi_dot^2*cos(psi)^2 - L^2*M*phi_dot^2*sin(psi)^2))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) - ((2*cos(psi)*sin(psi)*L^2*M^2*R^2 - 4*Jm*sin(psi)*L*M*R*n^2)*(M*L^2 + 2*Jm*n^2 + J_psi)*(L*M*R*sin(psi)*psi_dot^2 + 2*bet*psi_dot + anp*(vl + vr) - the_dot*(2*bet + 2*fw)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi))^2 - ((2*cos(psi)*sin(psi)*L^2*M^2*R^2 - 4*Jm*sin(psi)*L*M*R*n^2)*(2*Jm*n^2 - L*M*R*cos(psi))*(M*cos(psi)*sin(psi)*L^2*phi_dot^2 + M*g*sin(psi)*L - anp*(vl + vr) - 2*bet*psi_dot + 2*bet*the_dot))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi))^2 + (L*M*R*sin(psi)*(M*cos(psi)*sin(psi)*L^2*phi_dot^2 + M*g*sin(psi)*L - anp*(vl + vr) - 2*bet*psi_dot + 2*bet*the_dot))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) + (L*M*R*psi_dot^2*cos(psi)*(M*L^2 + 2*Jm*n^2 + J_psi))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)),          ((2*bet + 2*L*M*R*psi_dot*sin(psi))*(M*L^2 + 2*Jm*n^2 + J_psi))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) - (2*bet*(2*Jm*n^2 - L*M*R*cos(psi)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)), 0,         (2*L^2*M*phi_dot*cos(psi)*sin(psi)*(2*Jm*n^2 - L*M*R*cos(psi)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi));
  0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    1, 0,                                                                                                                                                                                                                                                                                                  0;
  0, (2*bet*(2*Jw + M*R^2 + 2*Jm*n^2 + 2*R^2*m))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) - ((2*bet + 2*fw)*(2*Jm*n^2 - L*M*R*cos(psi)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)), ((L*M*g*cos(psi) + L^2*M*phi_dot^2*cos(psi)^2 - L^2*M*phi_dot^2*sin(psi)^2)*(2*Jw + M*R^2 + 2*Jm*n^2 + 2*R^2*m))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) - ((2*cos(psi)*sin(psi)*L^2*M^2*R^2 - 4*Jm*sin(psi)*L*M*R*n^2)*(2*Jm*n^2 - L*M*R*cos(psi))*(L*M*R*sin(psi)*psi_dot^2 + 2*bet*psi_dot + anp*(vl + vr) - the_dot*(2*bet + 2*fw)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi))^2 - ((2*cos(psi)*sin(psi)*L^2*M^2*R^2 - 4*Jm*sin(psi)*L*M*R*n^2)*(2*Jw + M*R^2 + 2*Jm*n^2 + 2*R^2*m)*(M*cos(psi)*sin(psi)*L^2*phi_dot^2 + M*g*sin(psi)*L - anp*(vl + vr) - 2*bet*psi_dot + 2*bet*the_dot))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi))^2 + (L*M*R*sin(psi)*(L*M*R*sin(psi)*psi_dot^2 + 2*bet*psi_dot + anp*(vl + vr) - the_dot*(2*bet + 2*fw)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) + (L*M*R*psi_dot^2*cos(psi)*(2*Jm*n^2 - L*M*R*cos(psi)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)), ((2*bet + 2*L*M*R*psi_dot*sin(psi))*(2*Jm*n^2 - L*M*R*cos(psi)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) - (2*bet*(2*Jw + M*R^2 + 2*Jm*n^2 + 2*R^2*m))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)), 0, (2*L^2*M*phi_dot*cos(psi)*sin(psi)*(2*Jw + M*R^2 + 2*Jm*n^2 + 2*R^2*m))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi));
  0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0, 0,                                                                                                                                                                                                                                                                                                  1;
  0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (8*L^2*M*R^4*cos(psi)*sin(psi)*((R^2*W^2*phi_dot*(bet + fw))/2 + (W*anp*(vl - vr))/(2*R) + 2*L^2*M*phi_dot*psi_dot*cos(psi)*sin(psi)))/(2*M*sin(psi)^2*L^2*R^2 + m*R^2*W^2 + 2*J_phi*R^2 + Jm*W^2*n^2 + Jw*W^2)^2 - (2*R^2*(2*L^2*M*phi_dot*psi_dot*cos(psi)^2 - 2*L^2*M*phi_dot*psi_dot*sin(psi)^2))/(2*J_phi*R^2 + Jw*W^2 + Jm*W^2*n^2 + R^2*W^2*m + 2*L^2*M*R^2*sin(psi)^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                    -(4*L^2*M*R^2*phi_dot*cos(psi)*sin(psi))/(2*J_phi*R^2 + Jw*W^2 + Jm*W^2*n^2 + R^2*W^2*m + 2*L^2*M*R^2*sin(psi)^2), 0,                                                                                                                                                     -(2*R^2*((R^2*W^2*(bet + fw))/2 + 2*L^2*M*psi_dot*cos(psi)*sin(psi)))/(2*J_phi*R^2 + Jw*W^2 + Jm*W^2*n^2 + R^2*W^2*m + 2*L^2*M*R^2*sin(psi)^2)];
 BB1 =...
[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0;
          (anp*(M*L^2 + 2*Jm*n^2 + J_psi))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) - (anp*(2*Jm*n^2 - L*M*R*cos(psi)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)),          (anp*(M*L^2 + 2*Jm*n^2 + J_psi))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) - (anp*(2*Jm*n^2 - L*M*R*cos(psi)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0;
 (anp*(2*Jm*n^2 - L*M*R*cos(psi)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) - (anp*(2*Jw + M*R^2 + 2*Jm*n^2 + 2*R^2*m))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)), (anp*(2*Jm*n^2 - L*M*R*cos(psi)))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi)) - (anp*(2*Jw + M*R^2 + 2*Jm*n^2 + 2*R^2*m))/(2*J_psi*Jw + L^2*M^2*R^2 + 2*Jw*L^2*M + J_psi*M*R^2 + 2*J_psi*Jm*n^2 + 4*Jm*Jw*n^2 + 2*J_psi*R^2*m + 2*Jm*L^2*M*n^2 + 2*Jm*M*R^2*n^2 + 2*L^2*M*R^2*m + 4*Jm*R^2*m*n^2 - L^2*M^2*R^2*cos(psi)^2 + 4*Jm*L*M*R*n^2*cos(psi));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                 (R*W*anp)/(2*J_phi*R^2 + Jw*W^2 + Jm*W^2*n^2 + R^2*W^2*m + 2*L^2*M*R^2*sin(psi)^2),                                                                                                                                                                                                                                                                                                                                                                                                                                                 -(R*W*anp)/(2*J_phi*R^2 + Jw*W^2 + Jm*W^2*n^2 + R^2*W^2*m + 2*L^2*M*R^2*sin(psi)^2)];
 

%%  
QQ =...
   [ 100   0     0     0     0   0;
     0     100     0     0     0     0;
     0     0     1     0     0     0;
     0     0     0     1     0     0;
     0     0     0     0     1     0;
     0     0     0     0     0     1];
RR = [5 0;0 5];
K = lqr(AA,BB,QQ,RR)